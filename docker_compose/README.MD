Devops Infra
============

Запуск контейнеров
------
- **Склонируйте репозиторий в `docker_compose/app/`**  
```
cd docker_compose/app
git clone git@gitlab.com:tfs18f-ekb-devops/public/application.git
```  

- **Задеплойте сервисы приложения**

Деплой происходит при помощи Docker Compose.  

```
cd docker_compose/
docker-compose up
```  

Docker Compose поднимет три контейнера с бд, редисом и приложением в подсети `app_net`.  
Редис и бд будут складывать свои данные с вольюмы `redis-data` и `postgres-data` соответственно.  

Откройте приложение в браузере по адресу `127.0.0.1:8080`


Примечания
------

- **Переменные окружения**  
Сервис приложения можно конфигурировать с помощью переменных окружения.  
Так приложение получает ссылку на rss-фид, уровень логгирования, адреса редиса и бд.  

Вкупе с возможностью Docker Compose наследования docker-compose.yml, это позволяет конфигурировать сервисы для разных окружений.  
Например, в файле `docker-compose.dev.yml` можно поднимать приложение с `LOG_LEVEL: INFO`  
В то время как `docker-compose.prod.yml` передавать `LOG_LEVEL: ERROR`  
Кроме того, Docker Compose позволяет выносить переменные в `.env` файлы и передавать их в `docker-compose.yml`

К сожалению, Docker Compose не предоставляет шифрования переменных окружения из коробки.

- **Сравнение с Ansible**

Предыдущее дз сделал с помощью Ansible. Вот что можно выделить:
Docker Compose это Ansible, только для докера. Соответственно он намного менее гибкий, не такое большое комьюнити и малое количество функционала из коробки.  

Кроме того, мультихостовый Docker Compose работает только в режиме swarm.  
Учитывая то, что сам swarm не очень используется и поддерживается, смысла от Docker Compose становится не сильно много.  
Поправьте, если ошибаюсь.
